DEBUG: ===== INICIANDO FUNCIÓN main =====
DEBUG: SCAN_ONLY = None
DEBUG: DATE_FROM = None
DEBUG: DATE_TO = None
DEBUG: HEADLESS = None
DEBUG: ACCOUNT_SEL = None
DEBUG: PYTHONUNBUFFERED = 1
DEBUG: Modo normal - iniciando transferencia
Arranca la Transferencia #1
DEBUG: Llamando a login_otp()...
DEBUG: ===== INICIANDO PROCESO DE LOGIN OTP =====
DEBUG: No se configuraron fechas - solo proceso OTP
DEBUG: Iniciando proceso de login...
DEBUG: Navegando a URL: https://app.lohas.eco/app_Login
DEBUG: URL actual después de navegar: https://app.lohas.eco/app_Login
DEBUG: Buscando campo de usuario: id_sc_field_login
DEBUG: Campo de usuario encontrado: <selenium.webdriver.remote.webelement.WebElement (session="3957297d8c71090f4f33591559c3b8e2", element="f.9F9108AC575A55CC05AA29157A6BEB50.d.8459EA6F8A852B9E5CB045EA16B04F6A.e.15")>
DEBUG: Usuario ingresado: briansw
DEBUG: Buscando campo de contraseña: id_sc_field_pswd
DEBUG: Campo de contraseña encontrado: <selenium.webdriver.remote.webelement.WebElement (session="3957297d8c71090f4f33591559c3b8e2", element="f.9F9108AC575A55CC05AA29157A6BEB50.d.8459EA6F8A852B9E5CB045EA16B04F6A.e.16")>
DEBUG: Contraseña ingresada
DEBUG: Buscando botón de login...
DEBUG: Botón de login encontrado: <selenium.webdriver.remote.webelement.WebElement (session="3957297d8c71090f4f33591559c3b8e2", element="f.9F9108AC575A55CC05AA29157A6BEB50.d.8459EA6F8A852B9E5CB045EA16B04F6A.e.57")>
DEBUG: Click en botón de login realizado
DEBUG: URL actual después del login: https://app.lohas.eco/app_control_2fa/
DEBUG: Esperando redirección al 2FA...
DEBUG: URL actual antes de esperar 2FA: https://app.lohas.eco/app_control_2fa/
DEBUG: ✅ Redirección a 2FA confirmada
DEBUG: URL actual después de esperar 2FA: https://app.lohas.eco/app_control_2fa/
DEBUG: Iniciando búsqueda de campo OTP...
DEBUG: Iniciando búsqueda de OTP con timeout=10
DEBUG: OTP_FIELD_ID = 'id_sc_field_code'
DEBUG: OTP_FIELD_NAME = 'code'
DEBUG: URL actual: https://app.lohas.eco/app_control_2fa/
DEBUG: 1) Buscando OTP por ID: 'id_sc_field_code'
DEBUG: Elemento encontrado por ID: <selenium.webdriver.remote.webelement.WebElement (session="3957297d8c71090f4f33591559c3b8e2", element="f.9F9108AC575A55CC05AA29157A6BEB50.d.55F9EB7FBDAB1C121B3B4DC8B5B0088A.e.74")>
DEBUG: Elemento visible: True
DEBUG: Elemento habilitado: True
DEBUG: ✅ OTP encontrado por ID y visible
DEBUG: ✅ Campo OTP encontrado exitosamente
DEBUG: Buscando todos los emails de lohas en la última hora...
DEBUG: Credenciales Gmail disponibles: brianswitach@gmail.com
DEBUG: Buscando emails desde: 03-Oct-2025
DEBUG: Encontrados 15 emails de sistema@lohas.eco en la última hora
DEBUG: Email 1 (UID 38091):
DEBUG:   Asunto: Código de acceso
DEBUG:   Cuerpo (primeros 200 chars):  Su código de inicio de sesión es  538812  , ingréselo en su sistema.   Si no ha podido generar el código, informe al administrador del sistema. 
...
DEBUG:   ✅ OTP encontrado: 538812
DEBUG: Email 2 (UID 38092):
DEBUG:   Asunto: Código de acceso
DEBUG:   Cuerpo (primeros 200 chars):  Su código de inicio de sesión es  775499  , ingréselo en su sistema.   Si no ha podido generar el código, informe al administrador del sistema. 
...
DEBUG:   ✅ OTP encontrado: 775499
DEBUG: Email 3 (UID 38093):
DEBUG:   Asunto: Código de acceso
DEBUG:   Cuerpo (primeros 200 chars):  Su código de inicio de sesión es  562543  , ingréselo en su sistema.   Si no ha podido generar el código, informe al administrador del sistema. 
...
DEBUG:   ✅ OTP encontrado: 562543
DEBUG: Email 4 (UID 38094):
DEBUG:   Asunto: Código de acceso
DEBUG:   Cuerpo (primeros 200 chars):  Su código de inicio de sesión es  906152  , ingréselo en su sistema.   Si no ha podido generar el código, informe al administrador del sistema. 
...
DEBUG:   ✅ OTP encontrado: 906152
DEBUG: Email 5 (UID 38095):
DEBUG:   Asunto: Código de acceso
DEBUG:   Cuerpo (primeros 200 chars):  Su código de inicio de sesión es  988747  , ingréselo en su sistema.   Si no ha podido generar el código, informe al administrador del sistema. 
...
DEBUG:   ✅ OTP encontrado: 988747
DEBUG: Buscando emails recientes de lohas (sin filtro de fecha)...
DEBUG: Total de emails de sistema@lohas.eco encontrados: 197
DEBUG: Email reciente 1 (UID 38093):
DEBUG:   Asunto: Código de acceso
DEBUG:   Cuerpo (primeros 200 chars):  Su código de inicio de sesión es  562543  , ingréselo en su sistema.   Si no ha podido generar el código, informe al administrador del sistema. 
...
DEBUG:   ✅ OTP encontrado: 562543
DEBUG: Email reciente 2 (UID 38094):
DEBUG:   Asunto: Código de acceso
DEBUG:   Cuerpo (primeros 200 chars):  Su código de inicio de sesión es  906152  , ingréselo en su sistema.   Si no ha podido generar el código, informe al administrador del sistema. 
...
DEBUG:   ✅ OTP encontrado: 906152
DEBUG: Email reciente 3 (UID 38095):
DEBUG:   Asunto: Código de acceso
DEBUG:   Cuerpo (primeros 200 chars):  Su código de inicio de sesión es  988747  , ingréselo en su sistema.   Si no ha podido generar el código, informe al administrador del sistema. 
...
DEBUG:   ✅ OTP encontrado: 988747
DEBUG: Preparando búsqueda de OTP con baseline UID...
DEBUG: Baseline UID establecido: 38095
DEBUG: Usando el último OTP encontrado...
DEBUG: Último UID encontrado: 38095
DEBUG: Último email (UID 38095):
DEBUG:   Asunto: Código de acceso
DEBUG:   Cuerpo (primeros 200 chars):  Su código de inicio de sesión es  988747  , ingréselo en su sistema.   Si no ha podido generar el código, informe al administrador del sistema. 
...
DEBUG: ✅ Código OTP obtenido del último email: 988747
DEBUG: Iniciando proceso de pegar OTP...
DEBUG: Limpiando campo OTP...
DEBUG: ✅ Campo OTP limpiado
DEBUG: Pegando código OTP: 988747
DEBUG: ✅ Código OTP pegado con JavaScript (sin formato)
DEBUG: Valor actual del campo: '9-8-8-7-4-7'
DEBUG: ✅ Verificación: código pegado correctamente (con formato automático)
DEBUG: Esperando 4s antes de confirmar/aceptar...
DEBUG: Buscando y clickeando botón Aceptar (1/2)...
DEBUG: ✅ Click en botón Aceptar 1/2 exitoso
DEBUG: Buscando y clickeando botón Aceptar (2/2, id=sub_form_b)...
DEBUG: ✅ Click en botón Aceptar 2/2 (sub_form_b) exitoso
DEBUG: Verificando salida de 2FA...
DEBUG: URL tras aceptar: https://app.lohas.eco/menu_cli/
DEBUG: Esperando 4s antes de ir a la grilla...
DEBUG: Navegando a grilla: https://app.lohas.eco/grid_movimientos_cuenta_usuario/
DEBUG: Esperando 3s para que cargue la grilla...
DEBUG: Buscando dropdown de cuentas...
DEBUG: Dropdown encontrado: <selenium.webdriver.remote.webelement.WebElement (session="3957297d8c71090f4f33591559c3b8e2", element="f.9F9108AC575A55CC05AA29157A6BEB50.d.577FF6ED31D1A07457498D176FFB4D81.e.123")>
DEBUG: Encontradas 2 opciones en el dropdown
DEBUG: Cuenta 1: BPMUP SRL871 (0000155300000000000871) PONDRA.CUARTO.BALDE
DEBUG: Cuenta 2: BPMUP SRL888 (0000155300000000000888) MAR.TEXTO.DESTILAN
DEBUG: Total de cuentas leídas: 2
DEBUG: ✅ Cuentas leídas exitosamente
DEBUG: Retornando True - flujo post-OTP completado
DEBUG: login_otp() retornó: True
Completada la Transferencia #1
