/Users/brianswitach/Documents/lohas/.venv/lib/python3.9/site-packages/urllib3/__init__.py:35: NotOpenSSLWarning: urllib3 v2 only supports OpenSSL 1.1.1+, currently the 'ssl' module is compiled with 'LibreSSL 2.8.3'. See: https://github.com/urllib3/urllib3/issues/3020
  warnings.warn(
DEBUG: ===== INICIANDO FUNCIÓN main =====
DEBUG: SCAN_ONLY = None
DEBUG: DATE_FROM = 2025-10-01
DEBUG: DATE_TO = 2025-10-02
DEBUG: HEADLESS = None
DEBUG: ACCOUNT_SEL = BPMUP SRL871 (0000155300000000000871) PONDRA.CUARTO.BALDE
DEBUG: PYTHONUNBUFFERED = 1
DEBUG: Modo normal - iniciando transferencia
Arranca la Transferencia #1
DEBUG: Llamando a login_otp()...
DEBUG: ===== INICIANDO PROCESO DE LOGIN OTP =====
DEBUG: Fechas configuradas: 2025-10-01 a 2025-10-02
DEBUG: Iniciando proceso de login...
DEBUG: Navegando a URL: https://app.lohas.eco/app_Login
DEBUG: URL actual después de navegar: https://app.lohas.eco/app_Login
DEBUG: Buscando campo de usuario: id_sc_field_login
DEBUG: Campo de usuario encontrado: <selenium.webdriver.remote.webelement.WebElement (session="2f44d1267cb01bcf0c8ece71671fd44c", element="f.D578A4CE75935A4B2E39EAD6D0AB54AB.d.89A78E206D23628D584F84087C1F3974.e.15")>
DEBUG: Usuario ingresado: briansw
DEBUG: Buscando campo de contraseña: id_sc_field_pswd
DEBUG: Campo de contraseña encontrado: <selenium.webdriver.remote.webelement.WebElement (session="2f44d1267cb01bcf0c8ece71671fd44c", element="f.D578A4CE75935A4B2E39EAD6D0AB54AB.d.89A78E206D23628D584F84087C1F3974.e.16")>
DEBUG: Contraseña ingresada
DEBUG: Buscando botón de login...
DEBUG: Botón de login encontrado: <selenium.webdriver.remote.webelement.WebElement (session="2f44d1267cb01bcf0c8ece71671fd44c", element="f.D578A4CE75935A4B2E39EAD6D0AB54AB.d.89A78E206D23628D584F84087C1F3974.e.57")>
DEBUG: Click en botón de login realizado
DEBUG: URL actual después del login: https://app.lohas.eco/app_control_2fa/
DEBUG: Esperando redirección al 2FA...
DEBUG: URL actual antes de esperar 2FA: https://app.lohas.eco/app_control_2fa/
DEBUG: ✅ Redirección a 2FA confirmada
DEBUG: URL actual después de esperar 2FA: https://app.lohas.eco/app_control_2fa/
DEBUG: Iniciando búsqueda de campo OTP...
DEBUG: Iniciando búsqueda de OTP con timeout=10
DEBUG: OTP_FIELD_ID = 'id_sc_field_code'
DEBUG: OTP_FIELD_NAME = 'code'
DEBUG: URL actual: https://app.lohas.eco/app_control_2fa/
DEBUG: 1) Buscando OTP por ID: 'id_sc_field_code'
DEBUG: Elemento encontrado por ID: <selenium.webdriver.remote.webelement.WebElement (session="2f44d1267cb01bcf0c8ece71671fd44c", element="f.D578A4CE75935A4B2E39EAD6D0AB54AB.d.48872B27C5BE10DA12F1E8DEB723D21A.e.74")>
DEBUG: Elemento visible: True
DEBUG: Elemento habilitado: True
DEBUG: ✅ OTP encontrado por ID y visible
DEBUG: ✅ Campo OTP encontrado exitosamente
DEBUG: Buscando todos los emails de lohas en la última hora...
DEBUG: Credenciales Gmail disponibles: brianswitach@gmail.com
DEBUG: Buscando emails desde: 06-Oct-2025
DEBUG: Encontrados 9 emails de sistema@lohas.eco en la última hora
DEBUG: Email 1 (UID 38217):
DEBUG:   Asunto: Código de acceso
DEBUG:   Cuerpo (primeros 200 chars):  Su código de inicio de sesión es  918851  , ingréselo en su sistema.   Si no ha podido generar el código, informe al administrador del sistema. 
...
DEBUG:   ✅ OTP encontrado: 918851
DEBUG: Email 2 (UID 38230):
DEBUG:   Asunto: Código de acceso
DEBUG:   Cuerpo (primeros 200 chars):  Su código de inicio de sesión es  778460  , ingréselo en su sistema.   Si no ha podido generar el código, informe al administrador del sistema. 
...
DEBUG:   ✅ OTP encontrado: 778460
DEBUG: Email 3 (UID 38231):
DEBUG:   Asunto: Código de acceso
DEBUG:   Cuerpo (primeros 200 chars):  Su código de inicio de sesión es  782539  , ingréselo en su sistema.   Si no ha podido generar el código, informe al administrador del sistema. 
...
DEBUG:   ✅ OTP encontrado: 782539
DEBUG: Email 4 (UID 38232):
DEBUG:   Asunto: Código de acceso
DEBUG:   Cuerpo (primeros 200 chars):  Su código de inicio de sesión es  681891  , ingréselo en su sistema.   Si no ha podido generar el código, informe al administrador del sistema. 
...
DEBUG:   ✅ OTP encontrado: 681891
DEBUG: Email 5 (UID 38233):
DEBUG:   Asunto: Código de acceso
DEBUG:   Cuerpo (primeros 200 chars):  Su código de inicio de sesión es  589973  , ingréselo en su sistema.   Si no ha podido generar el código, informe al administrador del sistema. 
...
DEBUG:   ✅ OTP encontrado: 589973
DEBUG: Buscando emails recientes de lohas (sin filtro de fecha)...
DEBUG: Total de emails de sistema@lohas.eco encontrados: 207
DEBUG: Email reciente 1 (UID 38231):
DEBUG:   Asunto: Código de acceso
DEBUG:   Cuerpo (primeros 200 chars):  Su código de inicio de sesión es  782539  , ingréselo en su sistema.   Si no ha podido generar el código, informe al administrador del sistema. 
...
DEBUG:   ✅ OTP encontrado: 782539
DEBUG: Email reciente 2 (UID 38232):
DEBUG:   Asunto: Código de acceso
DEBUG:   Cuerpo (primeros 200 chars):  Su código de inicio de sesión es  681891  , ingréselo en su sistema.   Si no ha podido generar el código, informe al administrador del sistema. 
...
DEBUG:   ✅ OTP encontrado: 681891
DEBUG: Email reciente 3 (UID 38233):
DEBUG:   Asunto: Código de acceso
DEBUG:   Cuerpo (primeros 200 chars):  Su código de inicio de sesión es  589973  , ingréselo en su sistema.   Si no ha podido generar el código, informe al administrador del sistema. 
...
DEBUG:   ✅ OTP encontrado: 589973
DEBUG: Preparando búsqueda de OTP con baseline UID...
DEBUG: Baseline UID establecido: 38234
DEBUG: Usando el último OTP encontrado...
DEBUG: Último UID encontrado: 38233
DEBUG: Último email (UID 38233):
DEBUG:   Asunto: Código de acceso
DEBUG:   Cuerpo (primeros 200 chars):  Su código de inicio de sesión es  589973  , ingréselo en su sistema.   Si no ha podido generar el código, informe al administrador del sistema. 
...
DEBUG: ✅ Código OTP obtenido del último email: 589973
DEBUG: Iniciando proceso de pegar OTP...
DEBUG: Limpiando campo OTP...
DEBUG: ✅ Campo OTP limpiado
DEBUG: Pegando código OTP: 589973
DEBUG: ✅ Código OTP pegado con JavaScript (sin formato)
DEBUG: Valor actual del campo: '5-8-9-9-7-3'
DEBUG: ✅ Verificación: código pegado correctamente (con formato automático)
DEBUG: Esperando 4s antes de confirmar/aceptar...
DEBUG: Buscando y clickeando botón Aceptar (1/2)...
DEBUG: ✅ Click en botón Aceptar 1/2 exitoso
DEBUG: Buscando y clickeando botón Aceptar (2/2, id=sub_form_b)...
DEBUG: ✅ Click en botón Aceptar 2/2 (sub_form_b) exitoso
DEBUG: Verificando salida de 2FA...
DEBUG: URL tras aceptar: https://app.lohas.eco/menu_cli/
DEBUG: Esperando 4s antes de ir a la grilla...
DEBUG: Navegando a grilla: https://app.lohas.eco/grid_movimientos_cuenta_usuario/
DEBUG: Esperando 3s para que cargue la grilla...
DEBUG: ▶︎ Modo filtros: seleccionar cuenta y fechas — account='BPMUP SRL871 (0000155300000000000871) PONDRA.CUARTO.BALDE', 2025-10-01 → 2025-10-02
DEBUG: Opciones en select2: 2
DEBUG: ✅ Cuenta seleccionada en dropdown
DEBUG: Fecha id=SC_fecha_hora_dia seteada='01' leida='01' ok=True
DEBUG: Fecha id=SC_fecha_hora_mes seteada='10' leida='10' ok=True
DEBUG: Fecha id=SC_fecha_hora_ano seteada='2025' leida='2025' ok=True
DEBUG: Fecha id=SC_fecha_hora_input_2_dia seteada='02' leida='02' ok=True
DEBUG: Fecha id=SC_fecha_hora_input_2_mes seteada='10' leida='10' ok=True
DEBUG: Fecha id=SC_fecha_hora_input_2_ano seteada='2025' leida='2025' ok=True
DEBUG: ✅ Filtros aplicados (cuenta y fechas). Esperando 4s...
DEBUG: ✅ Click en botón Búsqueda realizado
DEBUG: Esperando 3s tras Búsqueda para cargar resultados...
DEBUG: ✅ Click en botón Exportar realizado
DEBUG: ✅ Click en opción CSV realizado
DEBUG: Esperando 2s antes de click en Aceptar (bok)...
DEBUG: ❌ No se pudo hacer click en botón Aceptar (bok): Message: 
Stacktrace:
0   chromedriver                        0x00000001046282c0 cxxbridge1$str$ptr + 2897404
1   chromedriver                        0x00000001046201fc cxxbridge1$str$ptr + 2864440
2   chromedriver                        0x0000000104145540 _RNvCs47EqcsrPRmA_7___rustc35___rust_no_alloc_shim_is_unstable_v2 + 74324
3   chromedriver                        0x000000010418cefc _RNvCs47EqcsrPRmA_7___rustc35___rust_no_alloc_shim_is_unstable_v2 + 367632
4   chromedriver                        0x00000001041ce39c _RNvCs47EqcsrPRmA_7___rustc35___rust_no_alloc_shim_is_unstable_v2 + 635056
5   chromedriver                        0x00000001041810c0 _RNvCs47EqcsrPRmA_7___rustc35___rust_no_alloc_shim_is_unstable_v2 + 318932
6   chromedriver                        0x00000001045ebbb8 cxxbridge1$str$ptr + 2649844
7   chromedriver                        0x00000001045ef194 cxxbridge1$str$ptr + 2663632
8   chromedriver                        0x00000001045cc614 cxxbridge1$str$ptr + 2521424
9   chromedriver                        0x00000001045efa7c cxxbridge1$str$ptr + 2665912
10  chromedriver                        0x00000001045bdd4c cxxbridge1$str$ptr + 2461832
11  chromedriver                        0x000000010460f508 cxxbridge1$str$ptr + 2795588
12  chromedriver                        0x000000010460f68c cxxbridge1$str$ptr + 2795976
13  chromedriver                        0x000000010461fe48 cxxbridge1$str$ptr + 2863492
14  libsystem_pthread.dylib             0x00000001a03c4c08 _pthread_start + 136
15  libsystem_pthread.dylib             0x00000001a03bfba8 thread_start + 8

DEBUG: Esperando 10s antes de click en Descargar (idBtnDown)...
DEBUG: ❌ No se pudo hacer click en botón Descargar (idBtnDown): Message: 
Stacktrace:
0   chromedriver                        0x00000001046282c0 cxxbridge1$str$ptr + 2897404
1   chromedriver                        0x00000001046201fc cxxbridge1$str$ptr + 2864440
2   chromedriver                        0x0000000104145540 _RNvCs47EqcsrPRmA_7___rustc35___rust_no_alloc_shim_is_unstable_v2 + 74324
3   chromedriver                        0x000000010418cefc _RNvCs47EqcsrPRmA_7___rustc35___rust_no_alloc_shim_is_unstable_v2 + 367632
4   chromedriver                        0x00000001041ce39c _RNvCs47EqcsrPRmA_7___rustc35___rust_no_alloc_shim_is_unstable_v2 + 635056
5   chromedriver                        0x00000001041810c0 _RNvCs47EqcsrPRmA_7___rustc35___rust_no_alloc_shim_is_unstable_v2 + 318932
6   chromedriver                        0x00000001045ebbb8 cxxbridge1$str$ptr + 2649844
7   chromedriver                        0x00000001045ef194 cxxbridge1$str$ptr + 2663632
8   chromedriver                        0x00000001045cc614 cxxbridge1$str$ptr + 2521424
9   chromedriver                        0x00000001045efa7c cxxbridge1$str$ptr + 2665912
10  chromedriver                        0x00000001045bdd4c cxxbridge1$str$ptr + 2461832
11  chromedriver                        0x000000010460f508 cxxbridge1$str$ptr + 2795588
12  chromedriver                        0x000000010460f68c cxxbridge1$str$ptr + 2795976
13  chromedriver                        0x000000010461fe48 cxxbridge1$str$ptr + 2863492
14  libsystem_pthread.dylib             0x00000001a03c4c08 _pthread_start + 136
15  libsystem_pthread.dylib             0x00000001a03bfba8 thread_start + 8

DEBUG: Esperando 3s tras exportar/descargar para asegurarnos...
DEBUG: login_otp() retornó: True
Completada la Transferencia #1
